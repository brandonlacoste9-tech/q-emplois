# Q-Emplois Skill Configuration — KimiClaw Edition
# Fix 4: Migrated from OpenClaw to KimiClaw

name: qemplois
display_name: "Q-Emplois"
description: "Plateforme de mise en relation jobs/services au Québec"
version: "2.0.0"
author: "Colony OS"
provider: kimiclaw  # FIX 4: Changed from openclaw

# Model Configuration
model: kimi-k2.5
language: fr
region: ca-qc

# Skills exposed to the LLM
skills:
  - name: book_service
    description: "Réserver un service (plomberie, électricité, etc.)"
    parameters:
      - name: service_type
        type: string
        required: true
        enum: [plomberie, électricité, nettoyage, jardinage, déménagement]
      - name: date
        type: string
        required: true
        description: "Date souhaitée (YYYY-MM-DD)"
      - name: time
        type: string
        required: true
        description: "Heure souhaitée (HH:MM)"
      - name: address
        type: string
        required: true
        description: "Adresse complète"
    handler: booking_flow.BookingFlow.handle_message

  - name: find_providers
    description: "Trouver des prestataires disponibles"
    parameters:
      - name: service_type
        type: string
        required: true
      - name: location
        type: object
        required: true
        properties:
          lat: number
          lng: number
          address: string
      - name: date
        type: string
        required: true
    handler: booking_flow.BookingFlow._fetch_providers_api

  - name: geocode_address  # FIX 4: New registered skill
    description: "Convertir une adresse en coordonnées GPS"
    parameters:
      - name: address
        type: string
        required: true
    handler: booking_flow.BookingFlow._geocode

  - name: link_account
    description: "Lier un compte utilisateur à une plateforme"
    parameters:
      - name: platform
        type: string
        required: true
        enum: [whatsapp, telegram, signal]
      - name: user_id
        type: string
        required: true
      - name: phone
        type: string
        required: false
    handler: auth_handler.AuthHandler.create_session

  - name: verify_link
    description: "Vérifier si un utilisateur est lié"
    parameters:
      - name: platform
        type: string
        required: true
      - name: platform_user_id
        type: string
        required: true
    handler: auth_handler.AuthHandler.get_linked_user

# Webhook Configuration
webhooks:
  - event: booking.created
    endpoint: /api/webhooks/booking
    description: "Nouvelle réservation créée"
  
  - event: auth.linked
    endpoint: /api/webhooks/auth
    description: "Compte lié à une plateforme"
  
  - event: payment.completed
    endpoint: /api/webhooks/payment
    description: "Paiement complété"

# Platform Integrations
platforms:
  whatsapp:
    enabled: true
    bot_handler: bot_handler.WhatsAppHandler
    webhook_path: /webhooks/whatsapp
    
  telegram:
    enabled: true
    bot_handler: bot_handler.TelegramHandler
    webhook_path: /webhooks/telegram

# API Configuration
api:
  base_url: https://api.qemplois.ca
  timeout: 10
  retry_count: 3
  
# Redis Configuration (Law 25 native)
redis:
  ttl: 86400  # 24 hours
  prefix: "qemplois:"

# Quebec-specific settings
quebec:
  timezone: America/Toronto
  currency: CAD
  tax_rates:
    tps: 0.05
    tvq: 0.09975
  language_default: fr
  law25_compliant: true
